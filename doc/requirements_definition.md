**MaskOut ver1 要件定義 (初期シンプル版)**

**1. アプリの基本情報・目的**
    * **アプリ名称:** MaskOut
    * **学習対象言語:** 英語
    * **主な目的・目標:**
        * 弱く発音される細かい箇所（前置詞、副詞、冠詞など）の推測力と正しい運用能力の向上
        * 語彙力向上（特に基礎単語3000語以上）
        * フレーズの習得
        * リスニングで理解できるチャンクを、スピーキングで運用できるレベルに定着させる

**2. コア機能 (Masked Language Modeling)**
    * **マスキング戦略の基本方針:** 「チャンク内ランダム選択」方式
        * **チャンク分割:** 学習用スクリプト（エピソード全体）を、N単語ずつのチャンクに分割します。
            * **Nの値:** 初期バージョンでは固定値とします（例: N=6 または N=7）。
        * **初期学習フェーズ (N周):**
            * このフェーズはN回の周回で構成されます。
            * 各周回において、スクリプト内の各N単語チャンクから、「そのチャンク内でまだこの初期学習フェーズでマスクされていない単語」をランダムに1つ選びマスキングします。
            * これにより、N周が完了すると、スクリプト内の全ての単語が1回ずつマスキングの対象となった状態になります。
        * **問題形式:** 自己判定モード
            * ユーザーが頭の中で解答を考える。
            * 正解を表示し、それを見てユーザー自身が「正解だった」「不正解だった」をアプリに記録する。
    * **復習フェーズ:**
        * N周の初期学習フェーズが完了した後、初期学習フェーズで一度でも「不正解だった」と記録された単語を復習対象とします。
        * **出題順:** 復習対象となった単語が複数ある場合、それらの単語が登場するセリフを、**エピソードのセリフの順番で表示** し、復習対象の単語はマスキングして問題として提示します。
        * セリフ内に復習対象の単語が複数ある場合、Nの値（学習時のチャンク分割と同じ値）の範囲で１つだけになるようにマスク箇所を制限する。
        * ユーザーが「正解だった」と記録するまで、その単語は復習対象として残ります。全ての復習対象単語が「正解だった」と記録されたら復習フェーズ完了です。
    * **正誤判定:** ユーザーの自己申告に基づく。
    * **ヒント機能:** なし。
    * **解答の表示とフィードバック:** 正解の単語を表示するのみ。

**3. 学習コンテンツ (アニメのセリフデータ)**
    * **ユーザー入力データの形式:**
        * エピソードごとに個別のテキストファイルとしてユーザーが用意します。
        * 各ファイルは、1行1セリフのシンプルなテキスト形式とします。
    * **内部データ管理:** JSON形式で、セリフ情報、単語ごとの正誤履歴（初期学習フェーズ、復習フェーズ）、最終学習日などを記録。
    * **メタ情報:** なし (話者情報、日本語訳、タイムスタンプなし)
    * **学習単位:** エピソードごと。中断箇所からの再開機能あり。
    * **コンテンツ表示:** 現在の問題セリフのみ表示。
    * **音声連携:** OS標準のTextToSpeech (TTS) 機能を利用。
        * **TTS再生箇所:** マスキングされる前の完全なセリフ全体を再生します。
    * **補助機能:** なし。

**4. ユーザーインターフェース (UI) とユーザーエクスペリエンス (UX) (変更なし)**
    * **画面構成:** エピソード選択画面、学習画面、設定画面。
    * **進捗表示項目:** 初期学習フェーズの進捗 (現在の周回数 / N周)、復習フェーズの対象単語数など。
    * **操作性:** シンプルで直感的。
    * **デザイン:** シンプルで集中しやすいデザイン。

**5. 学習進捗管理 (変更なし)**
    * **記録する情報:** 学習日時、エピソードごとの単語別解答履歴。
    * **進捗の可視化:** エピソード選択画面にて、各エピソードの学習状況を数値やシンプルなプログレスバーで表示。
    * **復習機能:** コア機能の「復習フェーズ」にて実装。

**6. 技術要件 (変更なし)**
    * **開発プラットフォーム:** Linux / Windows
    * **データの保存場所:** ローカルドライブ

**7. 非機能要件 (変更なし)**
    * **オフライン利用:** 初期実装ではオフライン利用が前提。
    * **パフォーマンス:** ユーザー操作への応答は0.2秒以内、時間のかかる処理でも2秒以内を目指す。
    * **拡張性:** ユーザーがスクリプトデータ（テキストファイル）を追加・登録できる機能。
